<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GN-MATH Games</title>
  <!-- Link to V4 global stylesheet -->
  <link rel="stylesheet" href="../css/style.css" />

  <!-- GN-Math Specific Scripts & Analytics -->
  
  <script async src="https://stackpath.bootstrapcdn.com/adsense.js"></script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WX5VS54ZDW"></script>
  <meta name="google-adsense-account" content="ca-pub-5521219086088837" />
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "G-WX5VS54ZDW");
  </script>
  <script async src="https://fundingchoicesmessages.google.com/i/pub-5521219086088837?ers=1"></script>
  <script src="https://cdn.jsdelivr.net/gh/gn-math/gn-math.github.io@main/gnmath.js"></script>

  <!-- Custom CSS Overrides for GN-Math Card Elements -->
  <style>
    /* Adjust the appearance of the card image inside the dashboard-card */
    .dashboard-card .card-image {
      width: 100%;
      height: 140px;
      object-fit: cover;
      border-radius: 8px 8px 0 0;
    }

    /* Controls padding and layout inside each card */
    .dashboard-card .card-body {
      padding: 1rem;
      display: flex;
      flex-direction: column;
      flex: 1;
    }

    /* Title styling inside each card */
    .dashboard-card .card-title {
      margin: 0.5rem 0;
      font-size: 1.2em;
      color: #333;
    }

    /* Game description styling */
    .dashboard-card .card-description {
      flex: 1;
      color: #666;
      font-size: 0.9em;
      line-height: 1.4;
      margin-bottom: 1rem;
    }

    /* ‚ÄúPlay‚Äù button styling inside each card */
    .dashboard-card .play-btn {
      margin-top: auto;
      background: linear-gradient(135deg, #6720bd 0%, #8a2be2 100%);
      color: #fff;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.9em;
      text-transform: uppercase;
      transition: all 0.3s ease;
    }

    .dashboard-card .play-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(103, 32, 189, 0.3);
    }

    /* Subtle hover overlay on card image */
    .dashboard-card:hover .card-image {
      filter: brightness(0.9);
    }
  </style>
</head>

<body class="dashboard-page">
  <!-- ========== V4 Header ========== -->
  <header class="main-header light-bg">
    <div class="container">
      <div class="logo">
        <a href="../index.html">
          <img src="../images/logo-dark.png" alt="4SP Logo" style="height: 40px; cursor: pointer;" />
        </a>
      </div>
      <div class="auth-buttons">
        <button class="btn btn-login" onclick="window.location.href='../index.html'">HOME</button>
        <button id="logoutBtn" class="btn btn-login">LOG OUT</button>
      </div>
    </div>
  </header>

  <div class="dashboard-container">
    <!-- ========== V4 Sidebar ========== -->
    <aside class="sidebar slide-in" id="sidebar">
      <button id="toggleSidebar">‚ò∞</button>

      <div class="user-info">
        <div class="marquee-container">
          <span id="userName" class="marquee-content username">Loading‚Ä¶</span>
        </div>
        <div class="marquee-container">
          <span id="userEmail" class="marquee-content email">Loading‚Ä¶</span>
        </div>
      </div>

      <nav>
        <ul>
          <li>
            <a href="dashboard.html">
              <span class="icon">üè†</span><span class="label">Dashboard</span>
            </a>
          </li>
          <li>
            <a href="proxies.html">
              <span class="icon">üõ°Ô∏è</span><span class="label">Proxies</span>
            </a>
          </li>
          <li>
            <a href="soundboard.html">
              <span class="icon">üéµ</span><span class="label">Soundboard</span>
            </a>
          </li>
          <li>
            <a href="games.html" class="active">
              <span class="icon">üéÆ</span><span class="label">Games</span>
            </a>
          </li>
          <li>
            <a href="others.html">
              <span class="icon">‚ú®</span><span class="label">Others</span>
            </a>
          </li>
          <li>
            <a href="settings.html">
              <span class="icon">‚öôÔ∏è</span><span class="label">Settings</span>
            </a>
          </li>
          <li>
            <a href="#" id="signOutLink">
              <span class="icon">üîí</span><span class="label">LOG OUT</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- ========== Main Content Area ========== -->
    <main class="main-content fade-in">
      <!-- Section Header -->
      <div class="dashboard-header">
        <h2 class="dashboard-title">GN-MATH Games</h2>
      </div>

      <!-- ========== Game Cards Grid ========== -->
      <div class="dashboard-grid" id="gameGrid">
        <!-- ===== Static Example Card: Crazy Cattle 3D ===== -->
        <div class="dashboard-card" data-id="crazycattle3d" data-page="zones/crazycattle3d/index.html">
          <img
            src="../images/crazycattle3d.jpg"
            alt="Crazy Cattle 3D"
            class="card-image"
          />
          <div class="card-body">
            <h4 class="card-title">Crazy Cattle 3D</h4>
            <p class="card-description">
              Navigate your bovine in a 3D obstacle course‚Äîno downloads required.
            </p>
            <button class="play-btn" onclick="openZone('crazycattle3d')">
              Play
            </button>
          </div>
        </div>

        <!-- ===== Static Example Card: DriveMad ===== -->
        <div class="dashboard-card" data-id="drivemad" data-page="zones/drivemad/index.html">
          <img
            src="../images/drivemad.jpg"
            alt="DriveMad"
            class="card-image"
          />
          <div class="card-body">
            <h4 class="card-title">DriveMad</h4>
            <p class="card-description">
              Take control of the wheel in this high-speed driving challenge.
            </p>
            <button class="play-btn" onclick="openZone('drivemad')">
              Play
            </button>
          </div>
        </div>

        <!-- ===== Additional Game Cards ===== -->
        <!-- 
          To add more games, copy the structure below, replace `anothergame` with your zone ID,
          update the image filename and alt text, and change the title/description accordingly.

        <div class="dashboard-card" data-id="anothergame" data-page="zones/anothergame/index.html">
          <img
            src="../images/anothergame.jpg"
            alt="Another Game"
            class="card-image"
          />
          <div class="card-body">
            <h4 class="card-title">Another Game</h4>
            <p class="card-description">
              A brief description of Another Game goes here‚Äîexplain the objective or fun factor.
            </p>
            <button class="play-btn" onclick="openZone('anothergame')">
              Play
            </button>
          </div>
        </div>
        -->

      </div>
      <!-- ========== End Game Cards Grid ========== -->

      <!-- ========== Zone Viewer (Hidden by Default) ========== -->
      <div id="zoneViewer" style="margin-top: 2rem; display: none;">
        <div class="zone-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
          <div class="zone-title">
            <h2 id="zoneName" style="margin: 0;">Zone Name</h2>
            <span id="zoneId" style="display: none;"></span>
            <a id="zoneAuthor" href="#" target="_blank" style="margin-left: 1rem; color: var(--primary-color); text-decoration: none;">by Author</a>
          </div>
          <div class="zone-controls">
            <button onclick="fullscreenZone()" class="control-btn" style="margin-right: 0.5rem;">Fullscreen</button>
            <button onclick="aboutBlank()" class="control-btn" style="margin-right: 0.5rem;">Open in New Tab</button>
            <button onclick="downloadZone()" class="control-btn" style="margin-right: 0.5rem;">Download</button>
            <button onclick="closeZone()" class="control-btn">Close</button>
          </div>
        </div>
        <iframe id="zoneFrame" style="width: 100%; height: 600px; border: 1px solid #ccc; border-radius: 8px;"></iframe>
      </div>

      <!-- ========== Popup Overlay (Hidden by Default) ========== -->
      <div id="popupOverlay" style="display: none;">
        <div class="popup" style="background: white; padding: 1.5rem; border-radius: 8px; max-width: 500px; margin: 2rem auto; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);">
          <div class="popup-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h3 id="popupTitle" style="margin: 0;">Title</h3>
            <button id="popupClose" onclick="closePopup()" style="background: none; border: none; font-size: 1.5em; cursor: pointer;">√ó</button>
          </div>
          <div id="popupBody" style="font-size: 1rem; line-height: 1.5;">Content will be here</div>
        </div>
      </div>

      <!-- Fallback message if JavaScript is disabled -->
      <noscript>
        <p style="text-align: center; color: #ff4d4f; margin-top: 2rem;">
          JavaScript is required to load the game list. Please enable JavaScript in your browser settings.
        </p>
      </noscript>
    </main>
  </div>

  <!-- ========== V4 Footer ========== -->
  <footer style="padding: 1rem 0; text-align: center; color: #666;">
    <div class="footer-links">
      <a href="#" onclick="showContact(); return false;" style="margin: 0 1rem; color: var(--text-muted); text-decoration: none;">
        Contact
      </a>
      <a href="#" onclick="loadPrivacy(); return false;" style="margin: 0 1rem; color: var(--text-muted); text-decoration: none;">
        Privacy Policy
      </a>
      <a href="javascript:saveData()" style="margin: 0 1rem; color: var(--text-muted); text-decoration: none;">
        Export Data
      </a>
      <label for="importData" style="margin: 0 1rem; color: var(--text-muted); cursor: pointer; text-decoration: underline;">
        Import Data
      </label>
      <input type="file" id="importData" style="display: none;" onchange="loadData(event)" />
    </div>
  </footer>

  <!-- ========== GN-Math & Firebase Scripts ========== -->
  <script src="script.js"></script>
  <script>
    // Hook up logout just like dashboard.html
    const handleLogout = () => {
      if (window.firebase && firebase.auth) {
        firebase
          .auth()
          .signOut()
          .then(() => (location.href = "../login.html"))
          .catch((error) => console.error("Logout error:", error));
      } else {
        location.href = "../index.html";
      }
    };
    document.getElementById("logoutBtn").onclick = handleLogout;
    document.getElementById("signOutLink").onclick = handleLogout;

    // Sidebar toggle (same as dashboard)
    const toggleSidebarBtn = document.getElementById("toggleSidebar");
    const sidebar = document.getElementById("sidebar");
    toggleSidebarBtn.addEventListener("click", () => {
      sidebar.classList.toggle("collapsed");
      // If you add marquee elements in the sidebar, call updateMarquees() here:
      // setTimeout(updateMarquees, 550);
    });

    // Functions to open/close zones and manage the iframe:
    function openZone(zoneId) {
      const zone = {
        id: zoneId,
        name: zoneId.charAt(0).toUpperCase() + zoneId.slice(1),
        author: "Unknown",
      };
      document.getElementById("zoneName").textContent = zone.name;
      document.getElementById("zoneId").textContent = zone.id;
      document.getElementById("zoneAuthor").textContent = `by ${zone.author}`;
      document.getElementById("zoneAuthor").href = `zones/${zone.id}/index.html`;
      document.getElementById("zoneFrame").src = `zones/${zone.id}/index.html`;
      document.getElementById("zoneViewer").style.display = "block";
      window.scrollTo({ top: document.getElementById("zoneViewer").offsetTop, behavior: "smooth" });
    }

    function closeZone() {
      document.getElementById("zoneFrame").src = "";
      document.getElementById("zoneViewer").style.display = "none";
    }

    function fullscreenZone() {
      const iframe = document.getElementById("zoneFrame");
      if (iframe.requestFullscreen) {
        iframe.requestFullscreen();
      } else if (iframe.mozRequestFullScreen) {
        iframe.mozRequestFullScreen();
      } else if (iframe.webkitRequestFullscreen) {
        iframe.webkitRequestFullscreen();
      } else if (iframe.msRequestFullscreen) {
        iframe.msRequestFullscreen();
      }
    }

    function aboutBlank() {
      const iframe = document.getElementById("zoneFrame");
      const zoneSrc = iframe.src;
      window.open(zoneSrc, "_blank");
    }

    function downloadZone() {
      const zoneFile = document.getElementById("zoneFrame").src;
      const link = document.createElement("a");
      link.href = zoneFile;
      link.download = "";
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    // Popup functions (if you use any popups)
    function showPopup(title, content) {
      document.getElementById("popupTitle").textContent = title;
      document.getElementById("popupBody").textContent = content;
      document.getElementById("popupOverlay").style.display = "block";
    }

    function closePopup() {
      document.getElementById("popupOverlay").style.display = "none";
    }
  </script>
</body>

</html>
