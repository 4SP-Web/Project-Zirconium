<!DOCTYPE html>
<html lang="en">
	<head>
		<title>StrongDog XP</title>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
		<link rel="stylesheet" href="css/style.css"> <!-- Assuming styles will be in style.css -->
		<style>
			:root {
			  --red: rgb(220, 53, 69);
			  --green: rgb(40, 167, 69);
			  --ff: 'PrimaryFont', sans-serif;
			  --bg: #2e2e2e;
			  --purple-gradient: linear-gradient(135deg, #6720bd 0%, #8a2be2 100%);
			}
			body {
			  font-family: var(--ff);
			  margin: 0;
			  padding: 0;
			  background-color: var(--bg);
			  overflow-x: hidden;
			}
			.navbar {
			  background-color: rgba(50, 50, 50, 0.9);
			  backdrop-filter: blur(10px);
			  color: white;
			  padding: 15px 30px;
			  display: flex;
			  align-items: center;
			  justify-content: space-between;
			  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
			  position: sticky;
			  top: 0;
			  z-index: 1000;
			}
			.logo {
			  position: absolute;
			  left: 50%;
			  transform: translateX(-50%);
			  font-weight: 700;
			  font-size: 2.5rem;
			  letter-spacing: 1px;
			  transition: transform 0.3s ease;
			  text-decoration: none;
			  color: white;
			}
			.logo:hover {
			  transform: translateX(-50%) scale(1.025);
			}
			.logo .xp {
			  color: orange;
			  text-shadow: 0 0 10px rgba(255, 165, 0, 0.5);
			}
			.menu-icon {
				width: 30px;
				height: 22px;
				position: relative;
				cursor: pointer;
				display: inline-block;
			}
			.menu-icon span {
				background-color: #ccc;
				display: block;
				position: absolute;
				height: 4px;
				width: 100%;
				border-radius: 2px;
				opacity: 1;
				left: 0;
				transform: rotate(0deg);
				transition: .25s ease-in-out;
			}
			.menu-icon span:nth-child(1) { top: 0px; }
			.menu-icon span:nth-child(2) { top: 9px; }
			.menu-icon span:nth-child(3) { top: 18px; }

			.slide-menu {
			  position: fixed;
			  top: 0;
			  left: 0;
			  height: 100vh;
			  width: 300px;
			  background: linear-gradient(180deg, #333 0%, #2a2a2a 100%);
			  color: white;
			  box-shadow: 5px 0 20px rgba(0, 0, 0, 0.7);
			  z-index: 1003;
			  transition: transform 0.5s ease;
			  transform: translateX(-100%);
			  padding: 20px;
			  overflow-y: auto;
			  box-sizing: border-box;
			}
			.slide-menu.open {
				transform: translateX(0);
			}
			.categories > a {
				display: flex;
				align-items: center;
				padding: 12px 15px;
				color: #fff;
				text-decoration: none;
				border-radius: 8px;
				transition: all 0.3s ease;
				font-family: var(--ff);
				text-transform: uppercase;
				margin-bottom: 10px;
			}
			.categories > a:hover, .categories > a.active {
				background: var(--purple-gradient);
				transform: translateX(5px);
			}

			.search-bar {
			  padding: 0.8rem 1.2rem;
			  font-size: 1rem;
			  border-radius: 15px;
			  width: 275px;
			  border: 1px solid rgba(103, 32, 189, 0.2);
			  background-color: rgba(0, 0, 0, 0.4);
			  color: white;
			  transition: all 0.3s ease;
			}

			.games-grid {
			  display: flex;
			  flex-wrap: wrap;
			  padding: 20px;
			  justify-content: center;
			  gap: 10px;
			}
			.card {
			  border-radius: 15px;
			  width: 120px;
			  aspect-ratio: 1;
			  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
			  transition: all 0.4s ease;
			  position: relative;
			  overflow: hidden;
			}
			.card:hover {
			  transform: scale(1.1) translateY(-10px);
			  box-shadow: 0 10px 30px rgba(103, 32, 189, 0.4);
			}
			.card img {
			  width: 100%;
			  height: 100%;
			  object-fit: cover;
			  transition: transform 0.4s ease;
			}
			.images-hidden .card img {
				display: none;
			}
			.images-hidden .card figcaption {
				transform: translateY(1px);
				opacity: 1;
				background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.7));
			}

			.card figcaption {
			  position: absolute;
			  bottom: 0;
			  left: 0;
			  width: 100%;
			  background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
			  color: #ffffff;
			  padding: 10px 0;
			  transition: all 0.4s ease;
			  transform: translateY(100%);
			  opacity: 0;
			  text-align: center;
			  font-weight: 600;
			}
			.card:hover figcaption {
			  transform: translateY(1px);
			  opacity: 1;
			}

			/* Popup Modal Styles */
			.modal-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0,0,0,0.7);
				z-index: 2000;
				display: flex;
				justify-content: center;
				align-items: center;
				opacity: 0;
				visibility: hidden;
				transition: opacity 0.3s ease, visibility 0.3s ease;
			}
			.modal-overlay.visible {
				opacity: 1;
				visibility: visible;
			}
			.modal-content {
				background: #333;
				padding: 30px;
				border-radius: 15px;
				text-align: center;
				color: #fff;
				max-width: 400px;
				width: 90%;
				box-shadow: 0 5px 25px rgba(0,0,0,0.5);
			}
			.modal-content p {
				margin-top: 0;
				margin-bottom: 20px;
				font-size: 1.1em;
			}
			.modal-buttons button {
				padding: 10px 20px;
				border: none;
				border-radius: 8px;
				cursor: pointer;
				font-family: var(--ff);
				font-weight: 600;
				transition: all 0.2s ease;
				margin: 0 10px;
			}
			.modal-buttons button#confirm-yes {
				background: var(--purple-gradient);
				color: white;
			}
			.modal-buttons button#confirm-no {
				background-color: #555;
				color: white;
			}
			.modal-buttons button:hover {
				transform: translateY(-2px);
			}

			/* Settings Panel */
			.settings-panel {
				padding-top: 20px;
				border-top: 1px solid #444;
				margin-top: 20px;
			}
			.toggle-option {
			  display: flex;
			  justify-content: space-between;
			  align-items: center;
			  padding: 10px;
			  background: #222;
			  border-radius: 10px;
			}
			.toggle-option label {
			  font-size: 1.1rem;
			  color: white;
			}
			.toggle-option input[type="checkbox"] {
			  appearance: none;
			  width: 50px;
			  height: 25px;
			  background: #555555;
			  border-radius: 25px;
			  position: relative;
			  cursor: pointer;
			  outline: none;
			  transition: background 0.3s ease;
			}
			.toggle-option input[type="checkbox"]:checked {
			  background: var(--purple-gradient);
			}
			.toggle-option input[type="checkbox"]::before {
			  content: "";
			  position: absolute;
			  width: 21px;
			  height: 21px;
			  background: white;
			  border-radius: 50%;
			  top: 2px;
			  left: 2px;
			  transition: transform 0.3s ease;
			}
			.toggle-option input[type="checkbox"]:checked::before {
			  transform: translateX(25px);
			}

		</style>
	</head>
	<body>
		<div class="navbar">
			<div class="menu-icon" id="menuIcon">
				<span></span>
				<span></span>
				<span></span>
			</div>
			<a href="index.html" class="logo">strongdog<span class="xp">XP</span></a>
			<div class="search-container">
				<input
					type="text"
					class="search-bar"
					placeholder="Search for gamesâ€¦"
					id="searchInput"
					autocomplete="off"
				/>
			</div>
		</div>

		<div class="games-grid" id="allList">
			<!-- Game cards will be dynamically inserted here by your existing script -->
		</div>

		<div class="slide-menu" id="slideMenu">
			<div class="categories">
				<a href="https://4simpleproblems.github.io/dashboard.html" class="option-link">Back to 4SP</a>
				<a href="favs.html" class="option-link">Favorites</a>
				<a href="#" id="settingsBtn" class="option-link">Settings</a>
				<a href="about.html" class="option-link">About | Bugs | Request Games</a>
				<a href="./save/index.html" class="option-link">Save manager</a>
				<a href="https://discord.gg/dyyebUaqRS" class="option-link">Discord Server</a>
			</div>
			<div class="settings-panel" id="settingsPanel" style="display: none;">
				<div class="toggle-option">
					<label for="imageToggle">Show Game Icons</label>
					<input type="checkbox" id="imageToggle">
				</div>
			</div>
		</div>

		<!-- First Visit Popup -->
		<div class="modal-overlay" id="image-preference-modal">
			<div class="modal-content">
				<p>Do you want to see the images for the games? This can be changed later in settings.</p>
				<div class="modal-buttons">
					<button id="confirm-yes">Yes</button>
					<button id="confirm-no">No</button>
				</div>
			</div>
		</div>

		<script type="module">
			// Assuming your games data and card creation logic is in another script.
			// This script will handle the new functionality.
			import games from "./cards-data.js";

			const menuIcon = document.getElementById("menuIcon");
			const slideMenu = document.getElementById("slideMenu");
			const allListElement = document.getElementById("allList");
			const settingsBtn = document.getElementById("settingsBtn");
			const settingsPanel = document.getElementById("settingsPanel");
			const imageToggle = document.getElementById("imageToggle");
			const imagePrefModal = document.getElementById("image-preference-modal");
			const confirmYesBtn = document.getElementById("confirm-yes");
			const confirmNoBtn = document.getElementById("confirm-no");

			// --- Menu Logic ---
			menuIcon.addEventListener("click", (e) => {
				e.stopPropagation();
				slideMenu.classList.toggle("open");
			});
			document.addEventListener("click", (e) => {
				if (!slideMenu.contains(e.target) && e.target !== menuIcon) {
					slideMenu.classList.remove("open");
				}
			});

			// --- Settings Panel Logic ---
			settingsBtn.addEventListener("click", (e) => {
				e.preventDefault();
				settingsPanel.style.display = settingsPanel.style.display === 'none' ? 'block' : 'none';
			});

			// --- Image Preference Logic ---
			function applyImagePreference() {
				const preference = localStorage.getItem('imagePreference');
				if (preference === 'hide') {
					document.body.classList.add('images-hidden');
					imageToggle.checked = false;
				} else {
					document.body.classList.remove('images-hidden');
					imageToggle.checked = true;
				}
			}

			function checkFirstVisit() {
				if (!localStorage.getItem('hasVisited')) {
					imagePrefModal.classList.add('visible');
				}
			}

			confirmYesBtn.addEventListener('click', () => {
				localStorage.setItem('imagePreference', 'show');
				localStorage.setItem('hasVisited', 'true');
				imagePrefModal.classList.remove('visible');
				applyImagePreference();
			});

			confirmNoBtn.addEventListener('click', () => {
				localStorage.setItem('imagePreference', 'hide');
				localStorage.setItem('hasVisited', 'true');
				imagePrefModal.classList.remove('visible');
				applyImagePreference();
			});

			imageToggle.addEventListener('change', () => {
				if (imageToggle.checked) {
					localStorage.setItem('imagePreference', 'show');
				} else {
					localStorage.setItem('imagePreference', 'hide');
				}
				applyImagePreference();
			});
			
			// --- Initial Load ---
			document.addEventListener('DOMContentLoaded', () => {
				// Your existing game loading logic should be here
				// For demonstration, I'll add a simplified version
				function getCardHTML(game) {
					const { name, imgSrc, id } = game;
					const gameLink = `./play/?id=${id}`;
					return `
					<a href="${gameLink}" class="card">
						<img src="./img/${imgSrc}" alt="${name}" loading="lazy">
						<figcaption>${name}</figcaption>
					</a>
					`;
				}
				allListElement.innerHTML = games.map(g => getCardHTML(g)).join("");


				// Apply settings and check for first visit
				applyImagePreference();
				checkFirstVisit();
			});

		</script>

	</body>
</html>
