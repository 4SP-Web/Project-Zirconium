<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4SP - HOME</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&display=swap" rel="stylesheet">
    <script src="/panic-key.js"></script>
    <script src="/url-changer.js"></script>
    
    <style>
        /* This inline style ensures the links are hidden by default before JS loads */
        .logged-in-link, .logged-out-link {
            display: none;
        }

        /* --- STICKY FOOTER & BODY STYLES --- */
        html, body {
            height: 100%;
        }
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        main {
            flex-grow: 1;
        }

        /* --- STYLES FOR VERSION HISTORY, WHAT'S NEW, & FOOTER --- */
        .timeline-section, .whats-new-section {
            padding: 80px 0;
            text-align: center;
        }

        .timeline-section {
            border-top: 1px solid #eee;
        }

        .whats-new-section {
            border-top: 1px solid #eee;
        }

        .timeline-section h2, .whats-new-section h2 {
            font-size: 2.8em;
            margin-bottom: 20px;
            color: #333;
            text-transform: uppercase;
            /* Using Oswald to mimic the external PrimaryFont */
            font-family: 'Oswald', sans-serif;
            font-weight: 700;
        }

        .whats-new-content {
            max-width: 950px; /* Made the section wider */
            margin: 40px auto 0 auto;
            text-align: left;
        }
            
        .whats-new-content p {
            font-size: 1.05em; /* Slightly smaller font */
            font-style: italic; /* Italicized text */
            line-height: 1.6;
            color: #555;
        }

        footer {
            background-color: #f8f8f8;
            color: #777;
            text-align: center;
            padding: 20px 0;
            border-top: 1px solid #eee;
        }


        /* --- STYLES FOR VERSION HISTORY TIMELINE --- */
        .timeline-container {
            position: relative;
            width: 100%;
            margin: 60px 0;
        }
        .timeline-wrapper {
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: relative;
        }
        /* The line connecting the dots */
        .timeline-wrapper::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 10%; 
            right: 10%;
            height: 2px;
            background-color: #e0e0e0;
            transform: translateY(-50%);
            z-index: 1;
        }

        .timeline-item {
            text-align: center;
            position: relative;
            z-index: 2; /* Sits on top of the line */
        }
        
        /* Remove default link styling */
        .timeline-item a {
            text-decoration: none;
            color: inherit;
            display: block; /* Make the whole area clickable */
        }

        /* The circle itself, created with a pseudo-element on the link */
        .timeline-item a::before {
            content: '';
            display: block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin: 0 auto 15px auto; /* Center the circle and add space below for text */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transition for hover effect */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        /* Hover effect to make the circle bigger */
        .timeline-item a:hover::before {
            transform: scale(1.2);
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }
        
        /* Specific gradient colors for each version's circle */
        .timeline-item:nth-child(1) a::before { background-image: linear-gradient(45deg, #434343 0%, #000000 100%); }
        .timeline-item:nth-child(2) a::before { background-image: linear-gradient(45deg, #87CEEB 0%, #4285F4 100%); }
        .timeline-item:nth-child(3) a::before { background-image: linear-gradient(45deg, #FEE140 0%, #FA709A 100%); }
        .timeline-item:nth-child(4) a::before { background-image: linear-gradient(45deg, #8820bd 0%, #6720BD 100%); }


        /* Styling for the text content within the timeline item */
        .timeline-item-content h3, .timeline-item-content p {
            margin: 0;
            padding: 0;
        }
        .timeline-item-content h3 {
            font-size: 1.1em;
            margin-bottom: 4px;
        }
        .timeline-item-content p {
            font-size: 0.9em;
            color: #666;
        }

    </style>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="../panic-key.js"></script>
</head>
<body>
    <main>
        <section class="hero-section dark-bg">
            <div class="container">
                <h1>4SIMPLEPROBLEMS</h1>
            </div>
        </section>

        <header class="main-header light-bg">
            <div class="container">
                <div class="logo">
                    <img src="images/logo-dark.png" alt="4SP Logo">
                </div>
                <nav class="main-nav">
                    <ul id="mainNavLinks">
                        <li class="dropdown" id="more-dropdown">
                            <a class="dropbtn">MORE</a>
                        </li>
                        <li class="logged-in-link"><a href="logged-in/dashboard.html">DASHBOARD</a></li>
                        </ul>
                </nav>
                <div class="auth-buttons" id="authButtons">
                </div>
            </div>
        </header>

        <section class="news-bar light-bg">
            <div class="container">
                <p>Fast. Secure. Yours.</p>
            </div>
        </section>
        <section class="hp-infra-section light-bg">
            <div class="container">
                <h2>over 120 users, and counting.</h2>
                <p>Engage in video games, modify your experience in the settings page, and have fun.</p>
            </div>
        </section>
        <section class="info-sections light-bg">
            <div class="container">
                <div class="info-item left-image">
                    <div class="info-content"><h3>ABOUT US</h3><p>We are the perfect website to have fun during boring school hours, disrupt everyone that hates these sounds, and to play some games when you have your work done, or don't. I don't care fr.</p></div>
                </div>
                <div class="info-item right-image">
                    <div class="info-content"><h3>SOUNDBOARD</h3><p>Unleash a barrage of sounds to playfully annoy your teachers. Perfect for those moments when you need a little mischief. your teachers will actually become "ðŸ˜¡" right to your face.</p></div>
                </div>
                <div class="info-item left-image">
                    <div class="info-content"><h3>OTHER STUFF</h3><p>We have a lot of other features implemented, like an entirely redesigned requests page, playlists page, and other stuff that i felt like adding bc i have free will</p></div>
                </div>
                <div class="info-item right-image">
                    <div class="info-content"><h3>THIS WEBSITE'S GOALS</h3><p>The goals for this website is to make the best, most fun experience for students that don't care about their academic grade, or who just don't care at all. I hate ads, and I love seeing the number of users go up. Alright?</p></div>
                </div>
                <div class="info-item left-image">
                    <div class="info-content"><h3>A NOTE ON PROXIES</h3><p>As a personal project without any income, I unfortunately cannot continue to manage and support the proxy servers. The costs and effort required are significant, especially while also working to support new features and fulfill all of your requests. The proxy services have been archived for now. I sincerely apologize for this inconvenience.</p></div>
                </div>
            </div>
        </section>

        <section class="timeline-section light-bg">
            <div class="container">
                <h2>VERSION HISTORY</h2>
                <div class="timeline-container">
                    <div class="timeline-wrapper">
                        <div class="timeline-item">
                            <a href="https://4simpleproblems.github.io/v1" target="_blank" rel="noopener noreferrer">
                                <div class="timeline-item-content">
                                    <h3>Version 1</h3>
                                    <p>March 13th, 2025</p>
                                </div>
                            </a>
                        </div>
                        <div class="timeline-item">
                            <a href="https://4simpleproblems.github.io/v2" target="_blank" rel="noopener noreferrer">
                                <div class="timeline-item-content">
                                    <h3>Version 2</h3>
                                    <p>April 11th, 2025</p>
                                </div>
                            </a>
                        </div>
                        <div class="timeline-item">
                            <a href="https://4simpleproblems.github.io/v3" target="_blank" rel="noopener noreferrer">
                                <div class="timeline-item-content">
                                    <h3>Version 3</h3>
                                    <p>May 14th, 2025</p>
                                </div>
                            </a>
                        </div>
                        <div class="timeline-item">
                            <a href="#">
                                <div class="timeline-item-content">
                                    <h3>Version 4</h3>
                                    <p>August 23rd, 2025</p>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="whats-new-section light-bg">
            <div class="container">
                <h2>WHAT'S NEW</h2>
                <div class="whats-new-content">
                    <p>
                        V4 is a massive overhaul focused on security and fun. Weâ€™ve added three distinct panic keys so you can instantly switch tabs to something safe. Speaking of which, our tab disguising is now fully customizable with presets, including a live clock preset that shows the current time, making it look completely legitimate. The biggest content drop is the new StrongdogXP section, packed with classics like Eaglercraft, the original Classic DOOM, and GN-Math for when you need a break. This is all on top of the redesigned dashboard, enhanced soundboard, and more secure account options. Go check it out.
                    </p>
                </div>
            </div>
        </section>
    </main>
    <footer>
        <div class="container">
            <p>&copy; 2025 4SP. All rights reserved.</p>
        </div>
    </footer>

    <div class="dropdown-content" id="more-menu-content">
        <div class="dropdown-header">MORE</div>
        <hr class="dropdown-divider">
        <a href="the-story.html">THE STORY</a>
        <a href="legal.html">LEGAL</a>
        <a href="https://buymeacoffee.com/4simpleproblems" target="_blank" rel="noopener noreferrer">DONATE</a>
    </div>

    <script>
        // --- NEW: One-Time Force Logout Script ---
        // This script runs once per user per browser to ensure data consistency
        // by forcing a re-login, which will trigger the account-fixing logic on the login page.
        (function() {
            const forceLogoutKey = 'forceLogoutCompleted_v1';
            // Check if the one-time logout has already been performed.
            if (!localStorage.getItem(forceLogoutKey)) {
                console.log('Performing one-time force logout to ensure data consistency...');
                // Use an auth state observer to ensure Firebase is ready.
                const unsubscribe = firebase.auth().onAuthStateChanged(user => {
                    unsubscribe(); // Stop listening after the first check.
                    if (user) {
                        // If a user is logged in, sign them out.
                        firebase.auth().signOut().then(() => {
                            localStorage.setItem(forceLogoutKey, 'true');
                            window.location.reload();
                        }).catch(error => {
                            // If signout fails for some reason, still set the flag and reload to avoid loops.
                            console.error('Force logout failed, but setting flag to prevent loop:', error);
                            localStorage.setItem(forceLogoutKey, 'true');
                            window.location.reload();
                        });
                    } else {
                        // If no user is logged in, just set the flag.
                        localStorage.setItem(forceLogoutKey, 'true');
                    }
                });
            }
        })();

        // Firebase Authentication Logic
        const authButtonsDiv = document.getElementById('authButtons');
        const loggedInLinks = document.querySelectorAll('.logged-in-link');
        const loggedOutLinks = document.querySelectorAll('.logged-out-link');

        function logout() {
            firebase.auth().signOut().catch(error => console.error('Error logging out:', error));
        }

        firebase.auth().onAuthStateChanged(user => {
            authButtonsDiv.innerHTML = '';
            if (user) {
                authButtonsDiv.innerHTML = `<a href="#" class="btn btn-logout" onclick="logout()">LOGOUT</a>`;
                loggedInLinks.forEach(link => link.style.display = 'inline-block');
                loggedOutLinks.forEach(link => link.style.display = 'none');
            } else {
                authButtonsDiv.innerHTML = `<a href="login.html" class="btn btn-login">LOGIN</a> <a href="signup.html" class="btn btn-signup">SIGN UP</a>`;
                loggedInLinks.forEach(link => link.style.display = 'none');
                loggedOutLinks.forEach(link => link.style.display = 'inline-block');
            }
        });

        // Dropdown Menu Logic
        document.addEventListener('DOMContentLoaded', () => {
            const dropdownTrigger = document.getElementById('more-dropdown');
            const dropdownContent = document.getElementById('more-menu-content');

            if (!dropdownTrigger || !dropdownContent) return;

            let hideTimeout;

            const showMenu = () => {
                clearTimeout(hideTimeout);
                const rect = dropdownTrigger.getBoundingClientRect();
                dropdownContent.style.top = `${window.scrollY + rect.bottom + 10}px`;
                dropdownContent.style.left = `${rect.left}px`;
                dropdownContent.classList.add('show');
            };

            const hideMenu = () => {
                hideTimeout = setTimeout(() => {
                    dropdownContent.classList.remove('show');
                }, 200);
            };

            dropdownTrigger.addEventListener('mouseenter', showMenu);
            dropdownTrigger.addEventListener('mouseleave', hideMenu);
            
            dropdownContent.addEventListener('mouseenter', () => clearTimeout(hideTimeout));
            dropdownContent.addEventListener('mouseleave', hideMenu);
        });
    </script>
</body>
</html>
