<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Secure Access Point</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link id="dynamic-favicon" rel="shortcut icon" type="image/x-icon" href="">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
  
  <style>
    :root {
      --dark-bg-primary: #121212;
      --dark-bg-secondary: #1e1e1e;
      --dark-text-primary: #e0e0e0;
      --dark-border-color: #3a3a3a;
      --dark-accent-purple: #6720bd;
    }
    html, body {
      height: 100%;
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background-color: var(--dark-bg-primary);
      color: var(--dark-text-primary);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    #loading-overlay {
      position: fixed;
      inset: 0;
      background-color: var(--dark-bg-primary);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 20px;
      opacity: 1;
      transition: opacity 0.8s ease-out;
    }
    #loading-overlay.is-hiding {
      opacity: 0;
      pointer-events: none;
    }
    #loading-spinner {
      border: 5px solid var(--dark-bg-secondary);
      border-top: 5px solid var(--dark-accent-purple);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1.5s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    #app-container {
      visibility: hidden;
      opacity: 0;
      height: 100%;
      display: flex;
      flex-direction: column;
      transition: opacity 0.8s ease-in;
    }
    #app-container.is-visible {
      visibility: visible;
      opacity: 1;
    }
    .main-header {
      background: var(--dark-bg-secondary);
      padding: 10px 20px;
      border-bottom: 1px solid var(--dark-border-color);
      display: flex;
      justify-content: flex-end;
      align-items: center;
    }
    .header-buttons {
      display: flex;
      gap: 15px;
    }
    .header-btn {
      background-color: var(--dark-bg-secondary);
      color: var(--dark-text-primary);
      border: 1px solid var(--dark-border-color);
      padding: 8px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Roboto', sans-serif;
      font-weight: bold;
      transition: background-color 0.2s, color 0.2s;
    }
    .header-btn:hover {
      background-color: var(--dark-accent-purple);
      color: white;
    }
    .main-content {
      flex: 1;
      display: flex;
    }
    .proxy-iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: var(--dark-bg-primary);
    }
  </style>
</head>
<body>

  <div id="loading-overlay">
    <div id="loading-spinner"></div>
    <p>DECRYPTING PAYLOAD...</p>
  </div>

  <div id="app-container">
    <header class="main-header">
      <div class="header-buttons">
        <button id="openNewTabBtn" class="header-btn" title="Open in New Tab">OPEN IN NEW TAB</button>
        <button id="fullscreenBtn" class="header-btn" title="Fullscreen">FULLSCREEN</button>
      </div>
    </header>
    <main class="main-content">
      <iframe
        id="proxyFrame"
        class="proxy-iframe"
        src="about:blank"
        sandbox="allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts"
        allow="fullscreen; geolocation; microphone; camera"
        title="Secure Content">
      </iframe>
    </main>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // --- Element References ---
      const loadingOverlay = document.getElementById('loading-overlay');
      const appContainer = document.getElementById('app-container');
      const proxyFrame = document.getElementById('proxyFrame');
      const openNewTabBtn = document.getElementById('openNewTabBtn');
      const fullscreenBtn = document.getElementById('fullscreenBtn');
      const favicon = document.getElementById('dynamic-favicon');
      
      // --- Multilayered Encryption Details ---

      // This is the final, double-encrypted payload.
      // It was created by:
      // 1. Encrypting 'vernmax.surge.sh' with key1.
      // 2. Encrypting the result of step 1 with key2.
      const multiLayerPayload = 'U2FsdGVkX1+Q+51qKacbVvfzQG+z6tYjT1f3u0UaL7QjH0hXJgGzSDEdZ0J6V4W2V9pD/rD9V+3GvH6m0+9hGkL+fE87t33LwJ+K8Xk1qJpEGLuUv4k0eY0dI2T2H+Q2';

      // The secret keys for decryption. These must be kept in this exact order.
      const key2 = 'an-even-more-secret-outer-key-789'; // Outer layer key
      const key1 = 'a-very-secret-inner-key-456';   // Inner layer key

      function decryptPayload() {
        try {
          // Stage 1: Decrypt the outer layer using key2.
          const decryptedOuterLayerBytes = CryptoJS.AES.decrypt(multiLayerPayload, key2);
          const innerPayload = decryptedOuterLayerBytes.toString(CryptoJS.enc.Utf8);

          if (!innerPayload) {
            throw new Error("Outer layer decryption failed. Check key2.");
          }
          
          // Stage 2: Decrypt the inner layer using key1.
          const decryptedInnerLayerBytes = CryptoJS.AES.decrypt(innerPayload, key1);
          const finalUrl = decryptedInnerLayerBytes.toString(CryptoJS.enc.Utf8);

          if (!finalUrl) {
            throw new Error("Inner layer decryption failed. Check key1.");
          }

          return `https://${finalUrl}`;

        } catch (error) {
          console.error("A critical decryption error occurred:", error.message);
          // Display error to the user and stop execution.
          loadingOverlay.innerHTML = `<p style="color: #ff5555;">DECRYPTION FAILED. PAYLOAD COULD NOT BE READ.</p>`;
          return null;
        }
      }

      function initializeContent() {
        const decryptedUrl = decryptPayload();
        
        if (decryptedUrl && proxyFrame) {
          proxyFrame.src = decryptedUrl;

          // Set a default title and icon once content starts loading
          document.title = "Secure Session";
          favicon.href = "data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ°Ô∏è</text></svg>";
          
          // Show the app container after a short delay to allow rendering
          setTimeout(() => {
            appContainer.classList.add('is-visible');
            loadingOverlay.classList.add('is-hiding');
          }, 500);

        }
      }

      // --- Button Event Listeners ---
      
      fullscreenBtn.addEventListener('click', () => {
        if (!document.fullscreenElement) {
          proxyFrame.requestFullscreen().catch(err => alert(`Fullscreen Error: ${err.message}`));
        } else {
          document.exitFullscreen();
        }
      });
      
      openNewTabBtn.addEventListener('click', () => {
        const newTab = window.open('about:blank', '_blank');
        if (newTab) {
          const newTabContent = `
            <!DOCTYPE html>
            <html>
            <head>
              <title>${document.title}</title>
              <link rel="icon" href="${favicon.href}">
              <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"><\/script>
            </head>
            <body style="margin:0; overflow:hidden; background-color:#121212;">
              <iframe id="newProxyFrame" style="width:100vw; height:100vh; border:none;"></iframe>
              <script>
                const payload = '${multiLayerPayload}';
                const k2 = '${key2}';
                const k1 = '${key1}';
                
                try {
                  const innerPayload = CryptoJS.AES.decrypt(payload, k2).toString(CryptoJS.enc.Utf8);
                  const finalUrl = CryptoJS.AES.decrypt(innerPayload, k1).toString(CryptoJS.enc.Utf8);
                  
                  if (finalUrl) {
                    document.getElementById('newProxyFrame').src = 'https://' + finalUrl;
                  } else {
                    throw new Error('Decryption failed');
                  }
                } catch (e) {
                  document.body.innerHTML = '<p style="font-family:sans-serif; text-align:center; color:white;">Failed to load content in new tab.</p>';
                }
              <\/script>
            </body>
            </html>
          `;
          newTab.document.write(newTabContent);
          newTab.document.close();
        } else {
          alert('Popup blocked! Please allow popups for this site.');
        }
      });

      // --- Start Application ---
      initializeContent();
    });
  </script>
</body>
</html>
