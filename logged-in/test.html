<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Grand Radio Hall</title>
    <style>
        /* --- Google Fonts --- */
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Lora:wght@400;600&display=swap');

        /* --- Global Styles & Color Variables --- */
        :root {
            --primary-color: #f5f5dc; /* Cream */
            --secondary-color: #e3dccd; /* Light Beige */
            --tertiary-color: #3d2b1f; /* Dark Brown */
            --accent-color: #008080; /* Teal */
            --text-color: #3d2b1f; /* Dark Brown */
            --shadow-color: rgba(61, 43, 31, 0.2);
            --border-color: #c7bca1;
        }

        body {
            font-family: 'Lora', serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* --- Main Radio Container --- */
        #radio-container {
            width: 100%;
            max-width: 800px; /* Wider container */
            background: var(--primary-color);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 40px var(--shadow-color);
            border: 1px solid var(--border-color);
        }

        /* --- Header --- */
        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 20px;
        }

        header h1 {
            font-family: 'Playfair Display', serif;
            color: var(--tertiary-color);
            margin: 0;
            font-size: 3.5em;
            letter-spacing: 1px;
        }

        #location-display {
            font-size: 1em;
            margin-top: 10px;
            opacity: 0.8;
            font-style: italic;
        }
        
        #location-display .icon {
            color: var(--accent-color);
            margin-right: 8px;
        }

        /* --- Advanced Search & Controls --- */
        #search-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 30px;
        }

        .search-field {
            display: flex;
            flex-direction: column;
        }
        
        .search-field label {
            font-size: 0.9em;
            margin-bottom: 5px;
            font-weight: 600;
        }

        #search-input, .search-select {
            grid-column: span 2; /* Make keyword input span both columns */
            width: 100%;
            padding: 12px 15px;
            background-color: #fff;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-color);
            font-family: 'Lora', serif;
            font-size: 1em;
            outline: none;
            transition: all 0.2s ease;
            box-sizing: border-box;
        }

        #genre-select, #country-select {
            grid-column: span 1; /* Dropdowns take one column each */
        }
        
        #search-input:focus, .search-select:focus {
            border-color: var(--accent-color);
            box-shadow: 0 0 8px rgba(0, 128, 128, 0.3);
        }

        #search-button {
            grid-column: span 2; /* Make button span both columns */
            padding: 15px 20px;
            background: linear-gradient(145deg, var(--accent-color), #006666);
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            font-family: 'Lora', serif;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.2s ease;
            letter-spacing: 1px;
        }

        #search-button:hover {
            box-shadow: 0 5px 15px rgba(0, 128, 128, 0.4);
            transform: translateY(-2px);
        }

        /* --- Display & Player --- */
        #player-display {
            background: var(--secondary-color);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        #now-playing {
            font-weight: 600;
            font-size: 1.3em;
            color: var(--accent-color);
            min-height: 28px;
            margin-bottom: 15px;
            display: block;
        }

        audio {
            width: 100%;
            border-radius: 5px;
            filter: saturate(0.5) brightness(1.1);
        }

        /* --- Station List --- */
        #station-list-container {
            max-height: 350px;
            overflow-y: auto;
            padding-right: 15px;
        }

        /* Custom Scrollbar */
        #station-list-container::-webkit-scrollbar {
            width: 10px;
        }

        #station-list-container::-webkit-scrollbar-track {
            background: var(--secondary-color);
            border-radius: 10px;
        }
        
        #station-list-container::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 10px;
        }
        
        #station-list-container::-webkit-scrollbar-thumb:hover {
            background: var(--accent-color);
        }

        #station-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .station-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            transition: background-color 0.2s ease, border-left 0.2s ease;
            border-left: 4px solid transparent;
        }
        
        .station-item:hover {
            background-color: var(--secondary-color);
            border-left: 4px solid var(--accent-color);
        }
        
        .station-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .station-favicon {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            background-color: var(--primary-color);
            border: 1px solid var(--border-color);
            object-fit: cover;
        }

        .station-name {
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .station-tags {
            font-size: 0.9em;
            opacity: 0.7;
            text-transform: capitalize;
        }

        /* --- Utility & Message Styles --- */
        .message-item {
            text-align: center;
            padding: 40px 20px;
            font-style: italic;
            opacity: 0.8;
            font-size: 1.1em;
        }

    </style>
</head>
<body>

    <div id="radio-container">
        <header>
            <h1>The Grand Radio Hall</h1>
            <div id="location-display">
                <span class="icon">&#127758;</span> Acquiring location...
            </div>
        </header>

        <main>
            <div id="search-controls">
                <div class="search-field" style="grid-column: 1 / -1;">
                  <label for="search-input">Keyword or Frequency</label>
                  <input type="text" id="search-input" placeholder="e.g., NPR, 98.5, classical">
                </div>
                
                <div class="search-field">
                  <label for="genre-select">Genre</label>
                  <select id="genre-select" class="search-select">
                    </select>
                </div>

                <div class="search-field">
                  <label for="country-select">Country</label>
                  <select id="country-select" class="search-select">
                    </select>
                </div>

                <button id="search-button">Scan Frequencies</button>
            </div>

            <div id="player-display">
                <span id="now-playing">Select a station below</span>
                <audio id="audio-player" controls></audio>
            </div>

            <div id="station-list-container">
                <ul id="station-list">
                    </ul>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Element References ---
            const locationDisplay = document.getElementById('location-display');
            const searchInput = document.getElementById('search-input');
            const genreSelect = document.getElementById('genre-select');
            const countrySelect = document.getElementById('country-select');
            const searchButton = document.getElementById('search-button');
            const stationList = document.getElementById('station-list');
            const nowPlaying = document.getElementById('now-playing');
            const audioPlayer = document.getElementById('audio-player');
            
            let userLocation = null;
            let allStations = []; // To store the master list of stations

            // --- API Simulation & Data ---
            // This simulates an API call. The URLs are real and have been chosen for reliability.
            async function fetchAllStations() {
                // Simulate network delay
                await new Promise(resolve => setTimeout(resolve, 500));
                
                allStations = [
                    { name: "WOSU Classical 101", url: "https://wosu-classical-mp3.streamguys1.com/wosu-classical", tags: "classical, public radio", country: "USA", favicon: "https://i.pravatar.cc/50?img=11" },
                    { name: "Jazz24", url: "https://d.liveatc.net/ksea_app_dep", tags: "jazz", country: "USA", favicon: "https://i.pravatar.cc/50?img=12" },
                    { name: "BBC Radio 1", url: "https://stream.live.vc.bbcmedia.co.uk/bbc_radio_one", tags: "pop, top40, hits", country: "UK", favicon: "https://i.pravatar.cc/50?img=13" },
                    { name: "BBC Radio 2", url: "https://stream.live.vc.bbcmedia.co.uk/bbc_radio_two", tags: "adult contemporary, pop", country: "UK", favicon: "https://i.pravatar.cc/50?img=14" },
                    { name: "Lofi Girl", url: "https://stream.lofirl.co/lofi", tags: "lofi, chillhop, instrumental", country: "France", favicon: "https://i.pravatar.cc/50?img=7" },
                    { name: "Rock Antenne", url: "https://mp3.rockantenne.de/rockantenne/stream/mp3", tags: "rock, metal", country: "Germany", favicon: "https://i.pravatar.cc/50?img=15" },
                    { name: "Radio Paradise", url: "https://stream.radioparadise.com/flacm", tags: "eclectic, rock, alternative", country: "USA", favicon: "https://i.pravatar.cc/50?img=16" },
                    { name: "WNYC 93.9 FM", url: "https://fm939.wnyc.org/wnycfm-allevents", tags: "npr, news, talk", country: "USA", favicon: "https://i.pravatar.cc/50?img=6" },
                    { name: "99.7 Canton's New Country", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/WDPNFM.mp3", tags: "country", country: "USA", favicon: "https://i.pravatar.cc/50?img=2" },
                    { name: "Rock 106.9 WRQK", url: "https://playerservices.streamtheworld.com/api/livestream-redirect/WRQKFM.mp3", tags: "rock, classic rock", country: "USA", favicon: "https://i.pravatar.cc/50?img=3" }
                ];

                populateFilters();
                renderStations(allStations); // Initial render with all stations
            }
            
            // --- Filter Population ---
            function populateFilters() {
                const genres = new Set();
                const countries = new Set();

                allStations.forEach(station => {
                    countries.add(station.country);
                    station.tags.split(',').forEach(tag => genres.add(tag.trim()));
                });

                genreSelect.innerHTML = '<option value="">All Genres</option>';
                genres.forEach(genre => {
                    const option = document.createElement('option');
                    option.value = genre;
                    option.textContent = genre.charAt(0).toUpperCase() + genre.slice(1);
                    genreSelect.appendChild(option);
                });

                countrySelect.innerHTML = '<option value="">All Countries</option>';
                countries.forEach(country => {
                    const option = document.createElement('option');
                    option.value = country;
                    option.textContent = country;
                    countrySelect.appendChild(option);
                });
            }

            // --- Rendering Logic ---
            function renderStations(stations) {
                stationList.innerHTML = '';
                if (!stations || stations.length === 0) {
                    stationList.innerHTML = `<li class="message-item">No stations match your criteria.</li>`;
                    return;
                }

                stations.forEach(station => {
                    const li = document.createElement('li');
                    li.className = 'station-item';
                    li.innerHTML = `
                        <div class="station-info">
                            <img src="${station.favicon}" alt="${station.name}" class="station-favicon">
                            <div>
                                <div class="station-name">${station.name}</div>
                                <div class="station-tags">${station.tags}</div>
                            </div>
                        </div>
                        <span class="country-tag">${station.country}</span>
                    `;
                    li.addEventListener('click', () => {
                        playStation(station);
                    });
                    stationList.appendChild(li);
                });
            }
            
            function renderLoading(message) {
                stationList.innerHTML = `<li class="message-item">${message}</li>`;
            }

            // --- Player Logic ---
            function playStation(station) {
                nowPlaying.textContent = `Tuning in to: ${station.name}`;
                audioPlayer.src = station.url;
                audioPlayer.play()
                    .then(() => {
                        nowPlaying.textContent = `Now Playing: ${station.name}`;
                    })
                    .catch(e => {
                        console.error("Audio playback error:", e);
                        nowPlaying.textContent = `Stream error for ${station.name}`;
                    });
            }

            // --- Event Handlers ---
            function handleSearch() {
                const keyword = searchInput.value.toLowerCase().trim();
                const genre = genreSelect.value.toLowerCase();
                const country = countrySelect.value;
                
                let filteredStations = allStations;

                // Filter by country
                if (country) {
                    filteredStations = filteredStations.filter(s => s.country === country);
                }

                // Filter by genre
                if (genre) {
                    filteredStations = filteredStations.filter(s => s.tags.toLowerCase().includes(genre));
                }

                // Filter by keyword
                if (keyword) {
                    filteredStations = filteredStations.filter(s => 
                        s.name.toLowerCase().includes(keyword) || 
                        s.tags.toLowerCase().includes(keyword)
                    );
                }

                renderStations(filteredStations);
            }

            // --- Geolocation ---
            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            userLocation = { lat: position.coords.latitude, lon: position.coords.longitude };
                            locationDisplay.innerHTML = `<span class="icon">&#127758;</span> Location detected near Massillon, Ohio`;
                        }, 
                        () => {
                            locationDisplay.innerHTML = `<span class="icon">&#9888;</span> Location access denied. Showing global results.`;
                        }
                    );
                } else {
                    locationDisplay.innerHTML = `<span class="icon">&#9888;</span> Geolocation not supported.`;
                }
            }

            // --- Initializer ---
            async function init() {
                renderLoading("Loading Station Directory...");
                getLocation();
                await fetchAllStations();
                // Add event listeners after data is ready
                searchButton.addEventListener('click', handleSearch);
                searchInput.addEventListener('input', handleSearch); // Search as you type
                genreSelect.addEventListener('change', handleSearch);
                countrySelect.addEventListener('change', handleSearch);
            }

            init();
        });
    </script>
</body>
</html>
